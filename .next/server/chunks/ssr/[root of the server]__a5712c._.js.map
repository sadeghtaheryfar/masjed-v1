{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Asian/Documents/GitHub/masjed-v1/app/layout.jsx"],"sourcesContent":["\"use client\";\r\nimport \"../styles/globals.css\";\r\nimport { Suspense, useEffect, useState } from \"react\";\r\nimport Cookies from \"js-cookie\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport axios from \"axios\";\r\n// export const metadata = {\r\n//   title: \" masjed \",\r\n//   description: \"Generated by create next app\",\r\n// };\r\n\r\nexport default function RootLayout({ children }) {\r\n  const router = useRouter();\r\n  const params = useSearchParams();\r\n\r\n  useEffect(() => {\r\n    const fetching = async () => {\r\n      // بررسی اگر توکن از URL آمده است\r\n      const tokenFromParams = params.get(\"jwt\");\r\n      if (tokenFromParams) {\r\n        Cookies.set(\"token\", tokenFromParams);\r\n        window.history.replaceState(null, \"\", \"/\");\r\n        return;\r\n      }\r\n\r\n      // بررسی اگر توکن در کوکی ذخیره شده\r\n      const accessToken = Cookies.get(\"token\");\r\n      \r\n      if (!accessToken) {\r\n        // اگر توکن وجود نداشت، به صفحه لاگین هدایت می‌کنیم\r\n        try {\r\n          const url = await axios.get(\"/api/url\");\r\n          if (url.data) {\r\n            router.push(url.data.verify_url);\r\n          }\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      } else {\r\n        // اگر توکن وجود داشت، اعتبار آن را با API پروفایل بررسی می‌کنیم\r\n        try {\r\n          await axios.get(`/api/profile`, {\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              Authorization: `bearer ${accessToken}`,\r\n            },\r\n          });\r\n          // اگر خطایی نبود، یعنی توکن معتبر است\r\n        } catch (error) {\r\n          console.log(\"توکن نامعتبر است:\", error);\r\n          // در صورت خطا، توکن را حذف می‌کنیم و کاربر را به صفحه لاگین هدایت می‌کنیم\r\n          Cookies.remove(\"token\");\r\n          try {\r\n            const url = await axios.get(\"/api/url\");\r\n            if (url.data) {\r\n              router.push(url.data.verify_url);\r\n            }\r\n          } catch (urlError) {\r\n            console.log(urlError);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    \r\n    fetching();\r\n  }, []);\r\n\r\n  return (\r\n    <html dir=\"rtl\" lang=\"fa\">\r\n      <body className=\"relative\">\r\n        <Suspense>{children}</Suspense>\r\n      </body>\r\n    </html>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;;AAWe,SAAS,WAAW,EAAE,QAAQ,EAAE;IAC7C,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IAE7B,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,WAAW;YACf,iCAAiC;YACjC,MAAM,kBAAkB,OAAO,GAAG,CAAC;YACnC,IAAI,iBAAiB;gBACnB,qJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,SAAS;gBACrB,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,IAAI;gBACtC;YACF;YAEA,mCAAmC;YACnC,MAAM,cAAc,qJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;YAEhC,IAAI,CAAC,aAAa;gBAChB,mDAAmD;gBACnD,IAAI;oBACF,MAAM,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;oBAC5B,IAAI,IAAI,IAAI,EAAE;wBACZ,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU;oBACjC;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,GAAG,CAAC;gBACd;YACF,OAAO;gBACL,gEAAgE;gBAChE,IAAI;oBACF,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,EAAE;wBAC9B,SAAS;4BACP,QAAQ;4BACR,eAAe,CAAC,OAAO,EAAE,aAAa;wBACxC;oBACF;gBACA,sCAAsC;gBACxC,EAAE,OAAO,OAAO;oBACd,QAAQ,GAAG,CAAC,qBAAqB;oBACjC,0EAA0E;oBAC1E,qJAAA,CAAA,UAAO,CAAC,MAAM,CAAC;oBACf,IAAI;wBACF,MAAM,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;wBAC5B,IAAI,IAAI,IAAI,EAAE;4BACZ,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU;wBACjC;oBACF,EAAE,OAAO,UAAU;wBACjB,QAAQ,GAAG,CAAC;oBACd;gBACF;YACF;QACF;QAEA;IACF,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAK,KAAI;QAAM,MAAK;kBACnB,cAAA,8OAAC;YAAK,WAAU;sBACd,cAAA,8OAAC,qMAAA,CAAA,WAAQ;0BAAE;;;;;;;;;;;;;;;;AAInB"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}