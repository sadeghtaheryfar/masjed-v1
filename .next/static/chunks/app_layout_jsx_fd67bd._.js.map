{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Asian/Documents/GitHub/masjed-v1/app/layout.jsx"],"sourcesContent":["\"use client\";\r\nimport \"../styles/globals.css\";\r\nimport { Suspense, useEffect, useState } from \"react\";\r\nimport Cookies from \"js-cookie\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport axios from \"axios\";\r\n// export const metadata = {\r\n//   title: \" masjed \",\r\n//   description: \"Generated by create next app\",\r\n// };\r\n\r\nexport default function RootLayout({ children }) {\r\n  const router = useRouter();\r\n  const params = useSearchParams();\r\n\r\n  useEffect(() => {\r\n    const fetching = async () => {\r\n      // بررسی اگر توکن از URL آمده است\r\n      const tokenFromParams = params.get(\"jwt\");\r\n      if (tokenFromParams) {\r\n        Cookies.set(\"token\", tokenFromParams);\r\n        window.history.replaceState(null, \"\", \"/\");\r\n        return;\r\n      }\r\n\r\n      // بررسی اگر توکن در کوکی ذخیره شده\r\n      const accessToken = Cookies.get(\"token\");\r\n      \r\n      if (!accessToken) {\r\n        // اگر توکن وجود نداشت، به صفحه لاگین هدایت می‌کنیم\r\n        try {\r\n          const url = await axios.get(\"/api/url\");\r\n          if (url.data) {\r\n            router.push(url.data.verify_url);\r\n          }\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      } else {\r\n        // اگر توکن وجود داشت، اعتبار آن را با API پروفایل بررسی می‌کنیم\r\n        try {\r\n          await axios.get(`/api/profile`, {\r\n            headers: {\r\n              Accept: \"application/json\",\r\n              Authorization: `bearer ${accessToken}`,\r\n            },\r\n          });\r\n          // اگر خطایی نبود، یعنی توکن معتبر است\r\n        } catch (error) {\r\n          console.log(\"توکن نامعتبر است:\", error);\r\n          // در صورت خطا، توکن را حذف می‌کنیم و کاربر را به صفحه لاگین هدایت می‌کنیم\r\n          Cookies.remove(\"token\");\r\n          try {\r\n            const url = await axios.get(\"/api/url\");\r\n            if (url.data) {\r\n              router.push(url.data.verify_url);\r\n            }\r\n          } catch (urlError) {\r\n            console.log(urlError);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    \r\n    fetching();\r\n  }, []);\r\n\r\n  return (\r\n    <html dir=\"rtl\" lang=\"fa\">\r\n      <body className=\"relative\">\r\n        <Suspense>{children}</Suspense>\r\n      </body>\r\n    </html>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;;AAWe,SAAS,WAAW,EAAE,QAAQ,EAAE;;IAC7C,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IAE7B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;gCAAE;YACR,MAAM;iDAAW;oBACf,iCAAiC;oBACjC,MAAM,kBAAkB,OAAO,GAAG,CAAC;oBACnC,IAAI,iBAAiB;wBACnB,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,SAAS;wBACrB,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,IAAI;wBACtC;oBACF;oBAEA,mCAAmC;oBACnC,MAAM,cAAc,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;oBAEhC,IAAI,CAAC,aAAa;wBAChB,mDAAmD;wBACnD,IAAI;4BACF,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;4BAC5B,IAAI,IAAI,IAAI,EAAE;gCACZ,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU;4BACjC;wBACF,EAAE,OAAO,OAAO;4BACd,QAAQ,GAAG,CAAC;wBACd;oBACF,OAAO;wBACL,gEAAgE;wBAChE,IAAI;4BACF,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,CAAC,YAAY,CAAC,EAAE;gCAC9B,SAAS;oCACP,QAAQ;oCACR,eAAe,CAAC,OAAO,EAAE,aAAa;gCACxC;4BACF;wBACA,sCAAsC;wBACxC,EAAE,OAAO,OAAO;4BACd,QAAQ,GAAG,CAAC,qBAAqB;4BACjC,0EAA0E;4BAC1E,wJAAA,CAAA,UAAO,CAAC,MAAM,CAAC;4BACf,IAAI;gCACF,MAAM,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC;gCAC5B,IAAI,IAAI,IAAI,EAAE;oCACZ,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU;gCACjC;4BACF,EAAE,OAAO,UAAU;gCACjB,QAAQ,GAAG,CAAC;4BACd;wBACF;oBACF;gBACF;;YAEA;QACF;+BAAG,EAAE;IAEL,qBACE,6LAAC;QAAK,KAAI;QAAM,MAAK;kBACnB,cAAA,6LAAC;YAAK,WAAU;sBACd,cAAA,6LAAC,6JAAA,CAAA,WAAQ;0BAAE;;;;;;;;;;;;;;;;AAInB;GA/DwB;;QACP,qIAAA,CAAA,YAAS;QACT,qIAAA,CAAA,kBAAe;;;KAFR"}},
    {"offset": {"line": 114, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}